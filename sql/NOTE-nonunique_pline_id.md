## DUPLICATE pline_id WITH IDENTICAL COPIES

Gregor A says: First thing I noticed opening `ecglines_clean` is that the **pline_id** is non-unique.

Closer examination indicates that they are identical copies.

### Count duplicates

```
SELECT howmany || '        ' || pline_id FROM
    (
    SELECT pline_id, COUNT(*) AS howmany
    FROM ecglines_clean
    GROUP BY  pline_id
    ORDER BY howmany DESC
    ) as dupes
    WHERE howmany > 1
```

```
8 copies of 657234
5 copies of 659540
4 copies of 681679
4 copies of 661969
4 copies of 687448
4 copies of 869162
3 copies of 657330
3 copies of 781152
3 copies of 781149
3 copies of 781151
2 copies of 766916
2 copies of 776424
2 copies of 776587
2 copies of 657441
2 copies of 774502
2 copies of 784381
2 copies of 659257
2 copies of 657442
2 copies of 776426
2 copies of 774515
2 copies of 736476
2 copies of 766977
2 copies of 776591
2 copies of 776439
2 copies of 658482
2 copies of 689404
2 copies of 780578
2 copies of 781244
2 copies of 766963
2 copies of 766925
2 copies of 776427
2 copies of 659512
2 copies of 780263
2 copies of 776434
2 copies of 681801
2 copies of 657131
2 copies of 659482
2 copies of 657140
2 copies of 681671
2 copies of 776514
```


### Confirm exact duplicates

```
-- take the md5 hash of the name+type+geom etc. for all non-unique pline_id
-- matching hashes, confirm that these multiple copies are truly identical

SELECT pline_id || ' ' || md5(line_type || ' ' ||title || ' ' || st_astext(the_geom))
FROM ecglines_clean WHERE pline_id IN 
(SELECT pline_id FROM
    (
    SELECT pline_id, COUNT(*) AS howmany
    FROM ecglines_clean
    GROUP BY  pline_id
    ORDER BY howmany DESC
    ) as dupes
    WHERE howmany > 1
)
ORDER BY pline_id
```

```
657131 abc4ce3f87edaad6840034851eef512f
657131 abc4ce3f87edaad6840034851eef512f
657140 d4e20a17055104f1ed3990669a9a6e9c
657140 d4e20a17055104f1ed3990669a9a6e9c
657234 faca2ebfef9eb44fcd8aaac8e977f8ed
657234 faca2ebfef9eb44fcd8aaac8e977f8ed
657234 faca2ebfef9eb44fcd8aaac8e977f8ed
657234 faca2ebfef9eb44fcd8aaac8e977f8ed
657234 faca2ebfef9eb44fcd8aaac8e977f8ed
657234 faca2ebfef9eb44fcd8aaac8e977f8ed
657234 faca2ebfef9eb44fcd8aaac8e977f8ed
657234 faca2ebfef9eb44fcd8aaac8e977f8ed
657330 21090a8393b260ab532e58f424246a47
657330 21090a8393b260ab532e58f424246a47
657330 21090a8393b260ab532e58f424246a47
657441 3f286b0cd0e599698b824d074cce6462
657441 3f286b0cd0e599698b824d074cce6462
657442 aec5b94af955aae42371c53204e32e1c
657442 aec5b94af955aae42371c53204e32e1c
658482 e72431f9bcb2fdfebbeb352f1b07227b
658482 e72431f9bcb2fdfebbeb352f1b07227b
659257 2f295b0e928a122b9a7d7b0cf8b8b8a9
659257 2f295b0e928a122b9a7d7b0cf8b8b8a9
659482 e36dd9aa06ef4452144b78fe04cc14f7
659482 e36dd9aa06ef4452144b78fe04cc14f7
659512 745c6ea32e29cc79bd9a824427a5549a
659512 745c6ea32e29cc79bd9a824427a5549a
659540 cc04dd362aa51f05f3011bcb349638bd
659540 cc04dd362aa51f05f3011bcb349638bd
659540 cc04dd362aa51f05f3011bcb349638bd
659540 cc04dd362aa51f05f3011bcb349638bd
659540 cc04dd362aa51f05f3011bcb349638bd
661969 cb4dfc0d1c3fc90237b86779dd3fbb4a
661969 cb4dfc0d1c3fc90237b86779dd3fbb4a
661969 cb4dfc0d1c3fc90237b86779dd3fbb4a
661969 cb4dfc0d1c3fc90237b86779dd3fbb4a
681671 43e65989df27cb969d71abb835c7356b
681671 43e65989df27cb969d71abb835c7356b
681679 aa1a6f4e37a70d9057e677f8552291a5
681679 aa1a6f4e37a70d9057e677f8552291a5
681679 aa1a6f4e37a70d9057e677f8552291a5
681679 aa1a6f4e37a70d9057e677f8552291a5
681801 bd0db980b0b8ef7ac75dd0306fa446ad
681801 bd0db980b0b8ef7ac75dd0306fa446ad
687448 dfee5e76be71456cc132d98be0e97e03
687448 dfee5e76be71456cc132d98be0e97e03
687448 dfee5e76be71456cc132d98be0e97e03
687448 dfee5e76be71456cc132d98be0e97e03
689404 c62a908044656e4113c6cb1a5c92be0e
689404 c62a908044656e4113c6cb1a5c92be0e
736476 0cf4c77b5c2f268be7f991ea828b245a
736476 0cf4c77b5c2f268be7f991ea828b245a
766916 a9b414d36294694eb0d8e321543cf035
766916 a9b414d36294694eb0d8e321543cf035
766925 b9abb4ad698823f66cfbacee1aa5958c
766925 b9abb4ad698823f66cfbacee1aa5958c
766963 a05b2b9cb42533e8469934f485d2ea58
766963 a05b2b9cb42533e8469934f485d2ea58
766977 30042cc30408b80c9fe23c55744842e4
766977 30042cc30408b80c9fe23c55744842e4
774502 50049ece588aa982ce84abf0e8ea1109
774502 50049ece588aa982ce84abf0e8ea1109
774515 acc97bb826c65ec1552b7b577a0ba0ee
774515 acc97bb826c65ec1552b7b577a0ba0ee
776424 90855ed29ad0dfde894815c819f837e0
776424 90855ed29ad0dfde894815c819f837e0
776426 eb2017eaafcd873c4497c09122eac78e
776426 eb2017eaafcd873c4497c09122eac78e
776427 775857b50bbf0e191cc2a1566f8b040a
776427 775857b50bbf0e191cc2a1566f8b040a
776434 d0dfae23e13645d6357f677b5a4fec42
776434 d0dfae23e13645d6357f677b5a4fec42
776439 ec84c70525c20bdc5c89d494166b9459
776439 ec84c70525c20bdc5c89d494166b9459
776514 03eee2752f89baa653e0e2b648cd9a09
776514 03eee2752f89baa653e0e2b648cd9a09
776587 f08c2efe0714da0dff42868964519c61
776587 f08c2efe0714da0dff42868964519c61
776591 6f8fec1c7b2f4c6bcadbf3e333cab938
776591 6f8fec1c7b2f4c6bcadbf3e333cab938
780263 e7856dc97b065d709b4735c563d886d0
780263 e7856dc97b065d709b4735c563d886d0
780578 b977dce98c8c7800019a99a8610b81ca
780578 b977dce98c8c7800019a99a8610b81ca
781149 b19316f367de8e9190ae262beb291db8
781149 b19316f367de8e9190ae262beb291db8
781149 b19316f367de8e9190ae262beb291db8
781151 81b5ce31c9a9b909086ae0d9539e5c4e
781151 81b5ce31c9a9b909086ae0d9539e5c4e
781151 81b5ce31c9a9b909086ae0d9539e5c4e
781152 a2586fc1b8da92f5ea6647245c16fbde
781152 a2586fc1b8da92f5ea6647245c16fbde
781152 a2586fc1b8da92f5ea6647245c16fbde
781244 06cca3272e9c445884a075b63ec2dd1f
781244 06cca3272e9c445884a075b63ec2dd1f
784381 9d9420b1be8f01b98332dac7814507c1
784381 9d9420b1be8f01b98332dac7814507c1
869162 0fdee072d24328efd4f4e9fc73ba60bd
869162 0fdee072d24328efd4f4e9fc73ba60bd
869162 0fdee072d24328efd4f4e9fc73ba60bd
869162 0fdee072d24328efd4f4e9fc73ba60bd
```
